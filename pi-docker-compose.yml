version: '3'

networks:
  catalystVlan:
    external:
      name: bridge

services:
  seed-node:
    image: microsoft/dotnet:2.1-runtime-alpine
    networks:
      catalystVlan:
        ipv4_address: 192.168.1.28
    volumes:
      - "/home/pi/.Catalyst"
    ports:
      - "80:8000"
    deploy:
      placement:
        constraints: [node.hostname == swarm-master]

  node-1:
    image: adlnode.azurecr.io/pinode:latest
    networks:
      catalystVlan:
        ipv4_address: 192.168.1.29
    depends_on:
      - node-1-mempool
    volumes:
      - "/home/pi/.Catalyst"
    ports:
      - "12142:42042"
    deploy:
      placement:
        constraints: [node.hostname == rpi-1]

  node-1-mempool:
    image: redis:5-alpine3.8
    networks:
      catalystVlan:
        ipv4_address: 192.168.1.30
    deploy:
      placement:
        constraints: [node.hostname == rpi-1]

  node-2:
    image: adlnode.azurecr.io/pinode:latest
    networks:
      catalystVlan:
        ipv4_address: 192.168.1.31
    depends_on:
      - node-2-mempool
    volumes:
      - "/home/pi/.Catalyst"
    ports:
      - "12242:42042"
    deploy:
      placement:
        constraints: [node.hostname == rpi-2]

  node-2-mempool:
    image: redis:5-alpine3.8
    networks:
      catalystVlan:
        ipv4_address: 192.168.1.32
    deploy:
      placement:
        constraints: [node.hostname == rpi-2]

  node-3:
    image: adlnode.azurecr.io/pinode:latest
    networks:
      catalystVlan:
        ipv4_address: 192.168.1.33
    depends_on:
      - node-3-mempool
    volumes:
      - "/home/pi/.Catalyst"
    ports:
      - "12342:42042"
    deploy:
      placement:
        constraints: [node.hostname == rpi-3]

  node-3-mempool:
    image: redis:5-alpine3.8
    networks:
      catalystVlan:
        ipv4_address: 192.168.1.34
    deploy:
      placement:
        constraints: [node.hostname == rpi-3]

  node-4:
    image: adlnode.azurecr.io/pinode:latest
    networks:
      catalystVlan:
        ipv4_address: 192.168.1.35
    depends_on:
      - node-4-mempool
    volumes:
      - "/home/pi/.Catalyst"
    ports:
      - "12442:42042"
    deploy:
      placement:
        constraints: [node.hostname == rpi-4]

  node-4-mempool:
    image: redis:5-alpine3.8
    networks:
      catalystVlan:
        ipv4_address: 192.168.1.36
    deploy:
      placement:
        constraints: [node.hostname == rpi-4]

  node-5:
    image: adlnode.azurecr.io/pinode:latest
    networks:
      catalystVlan:
        ipv4_address: 192.168.1.37
    depends_on:
      - node-5-mempool
    volumes:
      - "/home/pi/.Catalyst"
    ports:
      - "12542:42042"
    deploy:
      placement:
        constraints: [node.hostname == rpi-5]

  node-5-mempool:
    image: redis:5-alpine3.8
    networks:
      catalystVlan:
        ipv4_address: 192.168.1.38
    deploy:
      placement:
        constraints: [node.hostname == rpi-5]

  node-6:
    image: adlnode.azurecr.io/pinode:latest
    networks:
      catalystVlan:
        ipv4_address: 192.168.1.39
    depends_on:
      - node-6-mempool
    volumes:
      - "/home/pi/.Catalyst"
    ports:
      - "12642:42042"
    deploy:
      placement:
        constraints: [node.hostname == rpi-6]

  node-6-mempool:
    image: redis:5-alpine3.8
    networks:
      catalystVlan:
        ipv4_address: 192.168.1.40
    deploy:
      placement:
        constraints: [node.hostname == rpi-6]
